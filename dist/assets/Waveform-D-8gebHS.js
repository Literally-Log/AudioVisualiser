import{r as d,a as B,j as f}from"./r3f-g1wBN0as.js";import{u as F}from"./index-BbBGfACN.js";import{Z as g,_ as v,a6 as x,a7 as b}from"./three-Bh83E8IK.js";import"./postprocessing-DfBAEU_l.js";function V(){const{frameDataRef:w,settings:r}=F(),h=d.useRef(null),o=Math.min(r.visualization.resolution*4,1024),l=r.visualization.scale,{geom:j,geom2:A,mat:D,mat2:M,line1:R,line2:q}=d.useMemo(()=>{const c=10*l,s=new Float32Array(o*3),n=new Float32Array(o*3);for(let e=0;e<o;e++){const y=(e/o-.5)*c;s[e*3]=y,s[e*3+1]=0,s[e*3+2]=0,n[e*3]=y,n[e*3+1]=0,n[e*3+2]=.3}const a=new g;a.setAttribute("position",new v(s,3));const i=new g;i.setAttribute("position",new v(n,3));const m=new x({color:"#ffffff",linewidth:2,transparent:!0,opacity:.9}),t=new x({color:"#888888",linewidth:1,transparent:!0,opacity:.4}),p=new b(a,m),u=new b(i,t);return{geom:a,geom2:i,mat:m,mat2:t,line1:p,line2:u}},[o,l]);return B(()=>{const c=w.current.timeDomainData,s=w.current.frequencyData;if(!c)return;const n=j.attributes.position,a=A.attributes.position,i=Math.max(1,Math.floor(c.length/o)),m=l*2;for(let t=0;t<o;t++){const p=((c[t*i]||128)/128-1)*m*r.sensitivity.overall;if(n.array[t*3+1]=p,s){const u=(s[t*i]||0)/255*r.sensitivity.overall*l;a.array[t*3+1]=u*2-1}}n.needsUpdate=!0,a.needsUpdate=!0,D.color.set(r.colors.primary),M.color.set(r.colors.secondary)}),f.jsxs("group",{ref:h,children:[f.jsx("primitive",{object:R}),f.jsx("primitive",{object:q})]})}export{V as default};
